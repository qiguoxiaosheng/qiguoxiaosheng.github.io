<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>qiguoxiaosheng&#39;s blogs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="qiguoxiaosheng&#39;s blogs">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="qiguoxiaosheng&#39;s blogs">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="qiguoxiaosheng">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="qiguoxiaosheng&#39;s blogs" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">qiguoxiaosheng&#39;s blogs</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-HashedWheelTimer原理解析" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/06/HashedWheelTimer%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90/" class="article-date">
  <time datetime="2020-07-06T07:59:42.074Z" itemprop="datePublished">2020-07-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/06/HashedWheelTimer%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90/">HashedWheelTimer原理解析</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/07/06/HashedWheelTimer%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90/" data-id="ckdnxw3xk000ct4p5377lgud7" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-OpenTSDB之Deferred解析" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/06/OpenTSDB%E4%B9%8BDeferred%E8%A7%A3%E6%9E%90/" class="article-date">
  <time datetime="2020-07-06T06:32:27.092Z" itemprop="datePublished">2020-07-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/06/OpenTSDB%E4%B9%8BDeferred%E8%A7%A3%E6%9E%90/">OpenTSDB之Deferred解析</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在OpenTSDB源代码中，Deferred出现频率之高，让人无法忽视它的存在，也是因为它，把代码看得云里雾里，是是而非。索性专门抽出一段时间，专门研究下Deferred究竟为何高（niu）深（bi）的技术。首先找到Deferred类的的说明：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> A thread-safe implementation of a deferred result <span class="keyword">for</span> easy asynchronous processing.</span><br><span class="line"> This implementation is based on Twisted<span class="string">'s Python &#123;@code Deferred&#125; API.</span></span><br><span class="line"><span class="string"> *   &lt;li&gt;&lt;"http://su.pr/1PlbY7"&gt;Deferred Reference&lt;/li&gt;</span></span><br><span class="line"><span class="string"> *   &lt;li&gt;&lt;"http://su.pr/608GS1"&gt;A tutorial (Deferred in depth)&lt;/li&gt;</span></span><br><span class="line"><span class="string"> *   &lt;li&gt;&lt;"http://su.pr/2D6G9l"&gt;Source code of &#123;@code defer.py&#125;&lt;/li&gt;</span></span><br><span class="line"><span class="string">This API is a simple and elegant way of managing asynchronous and dynamic "pipelines" (processing chains) without having to explicitly define a finite state machine.</span></span><br></pre></td></tr></table></figure>

<p>接着，顺藤摸瓜，找到了Twisted，官网资料看的一头雾水，干脆直接求助某度。以下摘录自大（网）牛（友）的总结，“Twisted is event-based, asynchronous framework ”，这个“异步”功能的代表就是 deferred。</p>
<p>deferred 的作用类似于“多线程”，负责保障多头连接、多项任务的异步执行。当然，deferred “异步”功能的实现，与多线程完全不同，具有以下特点：</p>
<p>１. deferred 产生的 event，是函数调用返回的对象；</p>
<p>２. deferred 代表一个连接任务，负责报告任务执行的延迟情况和最终结果；</p>
<p>３. 对deferred 的操作，通过预定的“事件响应器”（event handler）进行。</p>
<p>有了deferred，即可对任务的执行进行管理控制。防止程序的运行，由于等待某项任务的完成而陷入阻塞停滞，提高整体运行的效率。</p>
<p>如果编写过非阻塞网络程序的人都知道，C语言中有个函数connect, 原型是：int connect(int fd, const void *addr, int addrlen); 此函数发起一个套接字fd上的到server addr的连接。  如果fd是阻塞的，那么connect将一直阻塞直到连接成功建立或者连接失败。这个连接可能立即建立，也可能等待很久后才建立成功返回，那么程序将阻塞在这个地方，不能干其他的事情。这就是阻塞程序的缺点，但阻塞程序编程比较简单，而且在大多时候都是立即返回，所以在实际中并没有被淘汰。如果fd被设置成了非阻塞的，那么不论连接建立成功与否，connect会立即返回。如果出错或者连接已发起，但未成功，connect都会返回-1,但系统会设置errno,通过errno的值我们知道具体是出了什么错。这里我们关注的是errno的值[EINPROGRESS]，man手册是这样说的：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nonblocking I/O is enabled <span class="keyword">using</span> `O_NONBLOCK`, `O_NDELAY`, <span class="keyword">or</span> `FIOSNBIO`, <span class="keyword">and</span> the connection cannot be completed immediately. This is <span class="keyword">not</span> a failure. Make the `<span class="built_in">connect</span>()` call again a few seconds later. Alternatively, wait <span class="keyword">for</span> completion by calling `select()` <span class="keyword">and</span> selecting <span class="keyword">for</span> <span class="built_in">write</span>.</span><br></pre></td></tr></table></figure>

<p>这不是一个错误，这表明连接已经发起，但还未成功。我们可以在一个时间段以后通过getsockopt检查连接是否成功，也可以通过重新调用connect，或者select的监听可写来判断监听是否成功。 这三种可以根据自己的情况选用。</p>
<p>上面说了一些题外话，但对于我们理解defer确实大大有益。因为在用twisted编写网络服务器的时候，一般都是基于单线程事件处理，那么一旦某一个连接需要大量的时间，就会影响后续的连接，从而影响了系统在单位时间的吞吐量。这些需要花费大量时间的操作一般是指磁盘IO和数据库操作。如果让他们阻塞起，会白白浪费很多cpu时间，那么我们想要的就是它能够在调用后立即返回，我们去处理其他的事情。待到IO和数据库操作完成后有一个东西来通知我们，我们再去接着处理它。这样就能大大得提高了cpu的利用率，从而在资源一定的情况下提高了服务器的性能。而我们需要的这个它，就是 twisted为我提供的defer。</p>
<p>在twisted的multi callbacks 中有下面一段话，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Multiple callbacks can be added to a Deferred. The first callback in the Deferred&#39;s callback chain will be called with the result, the second with the result of the first callback, and so on. Why do we need this? Well, consider a Deferred returned by twisted.enterprise.adbapi - the result of a SQL query. A web widget might add a callback that converts this result into HTML, and pass the Deferred onwards, where the callback will be used by twisted to return the result to the HTTP client. The callback chain will be bypassed in case of errors or exceptions.</span><br></pre></td></tr></table></figure>

<p>通过这段话我们知道，我们可以给twisted添加多个callback，而且每一个callback都是以上一个的返回结果作为传入参数被调用，这些callback会被依次调用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">When the result is ready, give it to the Deferred object. .callback(result) if the operation succeeded, .errback(failure) if it failed. Note that failure is typically an instance of a twisted.python.failure.Failureinstance.</span><br><span class="line">Deferred object triggers previously-added (call&#x2F;err)back with the result or failure. Execution then follows the following rules, going down the chain of callbacks to be processed.</span><br><span class="line">Result of the callback is always passed as the first argument to the next callback, creating a chain of processors.</span><br><span class="line">If a callback raises an exception, switch to errback.</span><br><span class="line">An unhandled failure gets passed down the line of errbacks, this creating an asynchronous analog to a series to a series of except:statements.</span><br><span class="line">If an errback doesn&#39;t raise an exception or return a twisted.python.failure.Failure instance, switch to callback.</span><br></pre></td></tr></table></figure>




      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/07/06/OpenTSDB%E4%B9%8BDeferred%E8%A7%A3%E6%9E%90/" data-id="ckdnxw3xz001ft4p5hl6ja4u1" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Linux文件描述符" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/06/Linux%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6/" class="article-date">
  <time datetime="2020-07-06T02:05:12.540Z" itemprop="datePublished">2020-07-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/06/Linux%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6/">Linux文件描述符</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Linux系统将所有设备都当作文件来处理，而Linux用文件描述符来标识每个文件对象。文件描述符是一个非负的整数，它是一个索引值，指向内核中每个进程打开文件的记录表。 它描述了数据资源，以及如何访问该资源。</p>
<p>Linux标准文件描述符</p>
<table>
<thead>
<tr>
<th>文件描述符</th>
<th>缩写</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>STDIN</td>
<td>标准输入</td>
</tr>
<tr>
<td>1</td>
<td>STDOUT</td>
<td>标准输出</td>
</tr>
<tr>
<td>2</td>
<td>STDERR</td>
<td>标准错误输出</td>
</tr>
</tbody></table>
<p>查看硬盘信息：df -m<br>查看内存信息：free -m<br>查看CPU信息：cat /proc/cpuinfo<br>查看内核所能打开的线程数：cat /proc/sys/kernel/threads-max</p>
<p>文件描述符是内核存储的文件描述符表的索引。 内核响应调用而创建文件描述符，并将文件描述符与底层文件对象的某种抽象相关联，这些对象是实际的硬件设备，文件系统或其他任何东西。 因此，引用该文件描述符的进程的读取或写入调用将由内核来索引到正确的位置。lsof(list open files)是一个列出当前系统打开文件的工具。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@local ~]# lsof -p 109110</span><br><span class="line">COMMAND    PID  USER   FD      TYPE             DEVICE  SIZE/OFF      NODE NAME</span><br><span class="line">java    109110 hbase  cwd       DIR               0,39       420  87083228 /run/cloudera-scm-agent/process/1031-hbase-MASTER</span><br><span class="line">java    109110 hbase  rtd       DIR              8,195       254       128 /</span><br><span class="line">java    109110 hbase  txt       REG              8,195      7734  33706485 /usr/java/java_1.8/bin/java</span><br><span class="line">java    109110 hbase  mem       REG              8,195    995840  50332155 /usr/lib64/libstdc++.so.6.0.19</span><br><span class="line">java    109110 hbase  mem       REG              8,198     23800  16793677 /opt/cloudera/parcels/CDH-5.15.0-1.cdh5.15.0.p0.21/lib/hadoop/lib/native/libsnappy.so.1.1.4</span><br><span class="line">java    109110 hbase  mem       REG              8,198    139608  16793668 /opt/cloudera/parcels/CDH-5.15.0-1.cdh5.15.0.p0.21/lib/hadoop/lib/native/libhadoop.so.1.0.0</span><br><span class="line">java    109110 hbase  mem       REG              8,195      7652  51793784 /usr/java/java_1.8/jre/lib/amd64/libjaas_unix.so</span><br><span class="line">java    109110 hbase  mem       REG              8,195     68192  50332271 /usr/lib64/libbz2.so.1.0.6</span><br><span class="line">java    109110 hbase  mem       REG              8,195    157424  50332265 /usr/lib64/liblzma.so.5.2.2</span><br><span class="line">java    109110 hbase  mem       REG              8,195     90248  50507691 /usr/lib64/libz.so.1.2.7</span><br><span class="line">java    109110 hbase  mem       REG              8,195     99944  50332272 /usr/lib64/libelf-0.170.so</span><br><span class="line">java    109110 hbase  mem       REG              8,195     19896  50332190 /usr/lib64/libattr.so.1.1.0</span><br><span class="line">java    109110 hbase  mem       REG              8,195     88776  50764564 /usr/lib64/libgcc_s-4.8.5-20150702.so.1</span><br><span class="line">java    109110 hbase  mem       REG              8,195    297360  50431748 /usr/lib64/libdw-0.170.so</span><br><span class="line">java    109110 hbase  mem       REG              8,195     20032  50332193 /usr/lib64/libcap.so.2.22</span><br><span class="line">java    109110 hbase  mem       REG              8,195     86544  50431750 /usr/lib64/libnss_myhostname.so.2</span><br><span class="line">java    109110 hbase  mem       REG              8,195    105824  50764592 /usr/lib64/libresolv-2.17.so</span><br><span class="line">java    109110 hbase  mem       REG              8,195     31408  50764580 /usr/lib64/libnss_dns-2.17.so</span><br><span class="line">java    109110 hbase  mem       REG              8,195     93112  51794942 /usr/java/java_1.8/jre/lib/amd64/libnio.so</span><br><span class="line">java    109110 hbase  mem       REG              8,195    115814  51793778 /usr/java/java_1.8/jre/lib/amd64/libnet.so</span><br><span class="line">java    109110 hbase  mem       REG              8,195    647051  92507000 /usr/java/java_1.8/jre/lib/jsse.jar</span><br><span class="line">java    109110 hbase  mem       REG              8,195     50289  51793764 /usr/java/java_1.8/jre/lib/amd64/libmanagement.so</span><br><span class="line">java    109110 hbase  mem       REG              8,198    481535 167776404 /opt/cloudera/parcels/CDH-5.15.0-1.cdh5.15.0.p0.21/jars/log4j-1.2.16.jar</span><br></pre></td></tr></table></figure>

<p>lsof输出各列信息含义：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">COMMAND：进程的名称</span><br><span class="line">PID： 进程标识符</span><br><span class="line">USER：进程所有者</span><br><span class="line">FD：文件描述符，应用程序通过文件描述符识别该文件。如cwd, rtd, txt, mem, DEL, 0u, 3w, 4r等</span><br><span class="line">TYPE：文件类型，如DIR, REG, CHR, Ipv6, unix, FIFO等</span><br><span class="line">DEVICE：指定磁盘的名称</span><br><span class="line">SIZE/OFF：文件的大小</span><br><span class="line">NODE：索引节点</span><br><span class="line">NAME：打开文件的确切名称</span><br></pre></td></tr></table></figure>

<p>FD中r表示只读，w为只写模式，u表示该文件被打开处于读写模式；大写的W表示该应用程序具有对整个文件的写锁。TYPE列文件和目录分别为REG和DIR。而CHR和BLK分别表示字符和块设备或者unix, FIFO, Ipv6分表表示UNIX域套接字，FIFO队列和IP套接字。</p>
<p>查看当前进程打开了多少文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsof -n|awk ‘&#123;print $2&#125;’|sort|uniq -c|sort -nr|more | grep [PID]</span><br></pre></td></tr></table></figure>

<p>查看当前进程打开文件描述符数：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls /proc/[PID]/fd |wc -l</span><br></pre></td></tr></table></figure>

<h3 id="ulimit"><a href="#ulimit" class="headerlink" title="ulimit"></a>ulimit</h3><p>查看进程允许打开的最大文件句柄数：ulimit -n。设置进程能打开的最大文件句柄数：ulimit -n xxx。</p>
<p>ulimit在系统允许的情况下，提供对特定shell可利用的资源的控制（Provides control over the resources avaliable to the shell and to processes started by it, on systems that allow such control）。-H和-S选项设定指定资源的硬限制和软限制。硬限制设定之后不能再添加，而软限制则可以增加到硬限制规定的值。如果-H和-S选项都没有指定，则软限制和硬限制同时设定。限制值可以是指定资源的数值或者hard, soft, unlimited这些特殊值，其中hard代表当前硬限制, soft代表当前软件限制, unlimited代表不限制. 如果不指定限制值, 则打印指定资源的软限制值, 除非指定了-H选项.如果指定了不只一种资源, 则限制名和单位都会在限制值前显示出来.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@local ~]# ulimit -Sn</span><br><span class="line">65536</span><br><span class="line">[root@local ~]# ulimit -Hn</span><br><span class="line">65536</span><br></pre></td></tr></table></figure>

<p>需要注意的是ulimit提供的是对特定shell可利用的资源的控制，而shell是与具体用户相关的。因此ulimit提供的是对单个用户的限制。包括以下项：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@local ~]# ulimit -a</span><br><span class="line">core file size          (blocks, -c) 0</span><br><span class="line">data seg size           (kbytes, -d) unlimited</span><br><span class="line">scheduling priority             (-e) 0</span><br><span class="line">file size               (blocks, -f) unlimited</span><br><span class="line">pending signals                 (-i) 766843</span><br><span class="line">max locked memory       (kbytes, -l) 64</span><br><span class="line">max memory size         (kbytes, -m) unlimited</span><br><span class="line">open files                      (-n) 65536</span><br><span class="line">pipe size            (512 bytes, -p) 8</span><br><span class="line">POSIX message queues     (bytes, -q) 819200</span><br><span class="line">real-time priority              (-r) 0</span><br><span class="line">stack size              (kbytes, -s) 8192</span><br><span class="line">cpu time               (seconds, -t) unlimited</span><br><span class="line">max user processes              (-u) 766843</span><br><span class="line">virtual memory          (kbytes, -v) unlimited</span><br><span class="line">file locks                      (-x) unlimited</span><br></pre></td></tr></table></figure>

<p>其中就有个“open files”的限制，默认是65536，也就是这个用户最大可以打开65536个文件。如果使用ulimit -n修改最大文件打开数，那么只对当前shell用户有用，同时也只对当前shell和这个shell fork出来的子shell生效，重启之后会重新恢复为默认值。</p>
<p>limits.conf</p>
<p>limits.conf这个文件是在/etc/security/目录下，因此这个文件是出于安全考虑的。limits.conf文件是用于提供对系统中的用户所使用的资源进行控制和限制，对所有用户的资源设定限制是非常重要的，这可以防止用户发起针对处理器和内存数量等的拒绝服务攻击。这些限制必须在用户登录时限制。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">[root@lv215 ~]# cat /etc/security/limits.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> /etc/security/limits.conf</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash">This file sets the resource limits <span class="keyword">for</span> the users logged <span class="keyword">in</span> via PAM.</span></span><br><span class="line"><span class="meta">#</span><span class="bash">It does not affect resource limits of the system services.</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Also note that configuration files <span class="keyword">in</span> /etc/security/limits.d directory,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="built_in">which</span> are <span class="built_in">read</span> <span class="keyword">in</span> alphabetical order, override the settings <span class="keyword">in</span> this</span></span><br><span class="line"><span class="meta">#</span><span class="bash">file <span class="keyword">in</span> <span class="keyword">case</span> the domain is the same or more specific.</span></span><br><span class="line"><span class="meta">#</span><span class="bash">That means <span class="keyword">for</span> example that setting a <span class="built_in">limit</span> <span class="keyword">for</span> wildcard domain here</span></span><br><span class="line"><span class="meta">#</span><span class="bash">can be overriden with a wildcard setting <span class="keyword">in</span> a config file <span class="keyword">in</span> the</span></span><br><span class="line"><span class="meta">#</span><span class="bash">subdirectory, but a user specific setting here can be overriden only</span></span><br><span class="line"><span class="meta">#</span><span class="bash">with a user specific setting <span class="keyword">in</span> the subdirectory.</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Each line describes a <span class="built_in">limit</span> <span class="keyword">for</span> a user <span class="keyword">in</span> the form:</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash">&lt;domain&gt;        &lt;<span class="built_in">type</span>&gt;  &lt;item&gt;  &lt;value&gt;</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Where:</span></span><br><span class="line"><span class="meta">#</span><span class="bash">&lt;domain&gt; can be:</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - a user name</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - a group name, with @group syntax</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - the wildcard *, <span class="keyword">for</span> default entry</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - the wildcard %, can be also used with %group syntax,</span></span><br><span class="line"><span class="meta">#</span><span class="bash">                 <span class="keyword">for</span> maxlogin <span class="built_in">limit</span></span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash">&lt;<span class="built_in">type</span>&gt; can have the two values:</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - <span class="string">"soft"</span> <span class="keyword">for</span> enforcing the soft limits</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - <span class="string">"hard"</span> <span class="keyword">for</span> enforcing hard limits</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash">&lt;item&gt; can be one of the following:</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - core - limits the core file size (KB)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - data - max data size (KB)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - fsize - maximum filesize (KB)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - memlock - max locked-in-memory address space (KB)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - nofile - max number of open file descriptors</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - rss - max resident <span class="built_in">set</span> size (KB)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - stack - max stack size (KB)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - cpu - max CPU time (MIN)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - nproc - max number of processes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - as - address space <span class="built_in">limit</span> (KB)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - maxlogins - max number of logins <span class="keyword">for</span> this user</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - maxsyslogins - max number of logins on the system</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - priority - the priority to run user process with</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - locks - max number of file locks the user can hold</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - sigpending - max number of pending signals</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - msgqueue - max memory used by POSIX message queues (bytes)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - nice - max nice priority allowed to raise to values: [-20, 19]</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        - rtprio - max realtime priority</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash">&lt;domain&gt;      &lt;<span class="built_in">type</span>&gt;  &lt;item&gt;         &lt;value&gt;</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">*               soft    core            0</span></span><br><span class="line"><span class="meta">#</span><span class="bash">*               hard    rss             10000</span></span><br><span class="line"><span class="meta">#</span><span class="bash">@student        hard    nproc           20</span></span><br><span class="line"><span class="meta">#</span><span class="bash">@faculty        soft    nproc           20</span></span><br><span class="line"><span class="meta">#</span><span class="bash">@faculty        hard    nproc           50</span></span><br><span class="line"><span class="meta">#</span><span class="bash">ftp             hard    nproc           0</span></span><br><span class="line"><span class="meta">#</span><span class="bash">@student        -       maxlogins       4</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> End of file</span></span><br><span class="line">*        hard    nofile           65536</span><br><span class="line">*        soft    nofile           65536</span><br></pre></td></tr></table></figure>

<p>其中含义如下：</p>
<ul>
<li>第一列表示域（domain）,可以使用用户名（root等），组名（以@开头）,通配置*和%，%可以用于%group参数。</li>
<li>第二列表示类型(type),值可以是soft或者hard</li>
<li>第三列表示项目(item),值可以是core, data, fsize, memlock, nofile, rss, stack, cpu, nproc, as, maxlogins, maxsyslogins, priority, locks, msgqueue, nie, rtprio。其中nofile(Number of Open File）就是文件打开数。</li>
<li>第四列表示值.</li>
</ul>
<h3 id="为什么有限制？"><a href="#为什么有限制？" class="headerlink" title="为什么有限制？"></a>为什么有限制？</h3><p>为什么Linux内核对文件句柄数、线程和进程的最大打开数进行了限制？以及如果我们把它调的太大，会产生什么样的后果？</p>
<p>原因1 - 资源问题：the operating system needs memory to manage each open file, and memory is a limited resource - especially on embedded systems.<br>原因2 - 安全问题：if there were no limits, a userland software would be able to create files endlessly until the server goes down.</p>
<p>What’s more? If the file descriptors are tcp sockets, etc, then you risk using up a large amount for the socket buffers and other kernel objects, this memory is not going to be swappable.</p>
<p>最主要的是资源问题，为防止某一单一进程打开过多文件描述符而耗尽系统资源，对进程打开文件数做了限制。</p>
<p>参考文献：</p>
<ol>
<li><a href="https://mp.weixin.qq.com/s?subscene=3&amp;__biz=MzU0MzQ5MDA0Mw==&amp;mid=2247484040&amp;idx=1&amp;sn=5eeb3b777ea9c47267fc829fb2482b83&amp;chksm=fb0be81ccc7c610a385c3505a2aebe8708e0509ffd06afb05773af7dc93fc770c91a91e5f630&amp;scene=7&amp;ascene=65&amp;devicetype=android-29&amp;version=3.0.25.1805&amp;nettype=cmnet&amp;abtest_cookie=AAACAA%3D%3D&amp;lang=zh_CN&amp;exportkey=AUf1cgx2bjxGWSfWCBZr%2FKc%3D&amp;pass_ticket=F7zZsG2WgI8Oq9V2kkVUJtftv2JEEeLyA%2FXz9j1Av8pU2wezBmwORCa7f74brprY&amp;wx_header=1&amp;platform=win" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?subscene=3&amp;__biz=MzU0MzQ5MDA0Mw==&amp;mid=2247484040&amp;idx=1&amp;sn=5eeb3b777ea9c47267fc829fb2482b83&amp;chksm=fb0be81ccc7c610a385c3505a2aebe8708e0509ffd06afb05773af7dc93fc770c91a91e5f630&amp;scene=7&amp;ascene=65&amp;devicetype=android-29&amp;version=3.0.25.1805&amp;nettype=cmnet&amp;abtest_cookie=AAACAA%3D%3D&amp;lang=zh_CN&amp;exportkey=AUf1cgx2bjxGWSfWCBZr%2FKc%3D&amp;pass_ticket=F7zZsG2WgI8Oq9V2kkVUJtftv2JEEeLyA%2FXz9j1Av8pU2wezBmwORCa7f74brprY&amp;wx_header=1&amp;platform=win</a> 文件句柄？文件描述符？傻傻分不清楚</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/07/06/Linux%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6/" data-id="ckdnxw3xv0015t4p58c6sg9f2" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-入坑JavaCC" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/01/%E5%85%A5%E5%9D%91JavaCC/" class="article-date">
  <time datetime="2020-07-01T01:18:06.789Z" itemprop="datePublished">2020-07-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/01/%E5%85%A5%E5%9D%91JavaCC/">入坑JavaCC</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/07/01/%E5%85%A5%E5%9D%91JavaCC/" data-id="ckdnxw3y80025t4p53xtk4ou0" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-OpenTSDB查询过程解析" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/06/08/OpenTSDB%E6%9F%A5%E8%AF%A2%E8%BF%87%E7%A8%8B%E8%A7%A3%E6%9E%90/" class="article-date">
  <time datetime="2020-06-08T09:05:11.233Z" itemprop="datePublished">2020-06-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Develop/">Develop</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/06/08/OpenTSDB%E6%9F%A5%E8%AF%A2%E8%BF%87%E7%A8%8B%E8%A7%A3%E6%9E%90/">OpenTSDB查询过程解析</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>OpenTSDB进行查询过程的大致步骤为：</p>
<ol>
<li>网络层收到客户端的请求，将查询条件解析成TSQuery对象；</li>
<li>调用TSQuery.buildQueries()方法或buildQueriesAsync()方法，根据TSQuery封装TSSubQuery对象创建Query对象；</li>
<li>调用Query.run()方法或者runAsync()方法，该方法完成对Hbase表额查询及查询结果的整理。</li>
</ol>
<p>其中，TSQuery.buildQueries()也是通过调用buildQueriesAsync()方法来实现的。buildQueries()处代码为</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Compiles the TSQuery into an array of Query objects for execution.</span></span><br><span class="line"><span class="comment"> * If the user has not set a down sampler explicitly, and they don't want </span></span><br><span class="line"><span class="comment"> * millisecond resolution, then we set the down sampler to 1 second to handle</span></span><br><span class="line"><span class="comment"> * situations where storage may have multiple data points per second.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> tsdb The tsdb to use for &#123;<span class="doctag">@link</span> TSDB#newQuery&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> A deferred array of queries to wait on for compilation.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2.2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> Deferred&lt;Query[]&gt; buildQueriesAsync(<span class="keyword">final</span> TSDB tsdb) &#123;</span><br><span class="line">  <span class="comment">// 将TSSubQuery对象与解析得到的TsdbQuery对象一一对应</span></span><br><span class="line">  <span class="keyword">final</span> Query[] tsdb_queries = <span class="keyword">new</span> Query[queries.size()];</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">final</span> List&lt;Deferred&lt;Object&gt;&gt; deferreds =</span><br><span class="line">      <span class="keyword">new</span> ArrayList&lt;Deferred&lt;Object&gt;&gt;(queries.size());</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; queries.size(); i++) &#123;</span><br><span class="line">    <span class="comment">// 创建TsdbQuery对象</span></span><br><span class="line">    <span class="keyword">final</span> Query query = tsdb.newQuery();</span><br><span class="line">    <span class="comment">// 初始化TsdbQuery对象</span></span><br><span class="line">    deferreds.add(query.configureFromQuery(<span class="keyword">this</span>, i));</span><br><span class="line">    tsdb_queries[i] = query;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  class GroupFinished implements Callback&lt;Query[], ArrayList&lt;Object&gt;&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Query[] call(<span class="keyword">final</span> ArrayList&lt;Object&gt; deferreds) &#123;</span><br><span class="line">      <span class="keyword">return</span> tsdb_queries;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">"Query compile group callback"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> Deferred.group(deferreds).addCallback(<span class="keyword">new</span> GroupFinished());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>query.configureFromQuery()初始化TsdbQuery对象的大致过程如下：</p>
<ol>
<li>从TSQuery中查找相应的TSSubQuery对象，并根据该对象初始化TsdbQuery中的start_time，end_time，aggregator，downsampler，query_index等字段。</li>
<li>若该子查询使用tsuid进行查询，则检测tsuids字段中所有的metric是否相等</li>
<li>若该子查询未使用tsuid进行查询，则<ol>
<li>解析metric字段，获取对应的UID；</li>
<li>如果该子查询中使用了TagVFilter进行过滤，则需要解析其中涉及的tagk及tagv，获取对应的UID；</li>
<li>调用findGroupBys()方法，初始化group_bys字段及row_key_literals字段。findGroupBys()方法执行步骤如下：<ol>
<li>对TsdbQuery.filters集合按tagk进行排序；</li>
<li>迭代tagk相同的TagVFilter，记录TagVFilter.group_by字段为true的TagFilter的个数。如果此次迭代中存在的TagVLiteralOrFilter类型的TagFilter，则同时会用literals集合和literal_filters集合记录其相关信息。</li>
<li>根据步骤2中获取的信息，初始化TsdbQuery.group_bys字段及row_key_literals字段。</li>
</ol>
</li>
</ol>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/06/08/OpenTSDB%E6%9F%A5%E8%AF%A2%E8%BF%87%E7%A8%8B%E8%A7%A3%E6%9E%90/" data-id="ckdnxw3y4001ut4p5cdkag1v3" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenTSDB/" rel="tag">OpenTSDB</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-OpenTSDB数据存储规则" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/28/OpenTSDB%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E8%A7%84%E5%88%99/" class="article-date">
  <time datetime="2020-05-28T06:55:15.884Z" itemprop="datePublished">2020-05-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Develop/">Develop</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/28/OpenTSDB%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E8%A7%84%E5%88%99/">OpenTSDB数据存储规则</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>本小节主要记录OpenTSDB是如何存储数据的。</p>
<h4 id="rowkey"><a href="#rowkey" class="headerlink" title="rowkey"></a>rowkey</h4><table>
<thead>
<tr>
<th>salt</th>
<th>metric_uid</th>
<th>base_time</th>
<th>tagk1_uid</th>
<th>tagv1_uid</th>
<th>……</th>
<th>tagkN_uid</th>
<th>tagvN_uid</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h4 id="qualifier"><a href="#qualifier" class="headerlink" title="qualifier"></a>qualifier</h4><p>存储的时序数据的精度是秒级时，qualifier的长度为2个字节。从高位到低位来看，其中高12位 保存了从base_time开始的秒级偏移量（offset），接下来的4位是flag标志，主要用来标识该点的数据类型及所占用的字节长度。</p>
<table>
<thead>
<tr>
<th>2个字节，16位</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>offset</td>
<td>flag</td>
</tr>
<tr>
<td>12</td>
<td>4</td>
</tr>
</tbody></table>
<p>存储的时序数据的精度是毫秒时，qualifier的长度为4个字节，从高位到低位来看，高4位始终为1，用于标识其精度为毫秒级。接下来的22位保存了从base_time开始的毫秒级偏移量，随后的2位为保留位，暂无使用，最后4位为flag标识位，作用同上。</p>
<table>
<thead>
<tr>
<th>4字节，32位</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>填充1</td>
<td>offset</td>
<td>保留</td>
<td>flag</td>
</tr>
<tr>
<td>4位</td>
<td>22位</td>
<td>2位</td>
<td>4位</td>
</tr>
</tbody></table>
<p>flag 最高位表示数值的类型: 0表示整数，1表示浮点数；后三位表示值的长度：000表示1个字节，001表示2个字节，011表示4个字节，111表示8个字节。</p>
<h4 id="压缩优化"><a href="#压缩优化" class="headerlink" title="压缩优化"></a>压缩优化</h4><p>为了节省存储空间，OpenTSDB在写入时会将rowkey记录到compactionQueue中，并启动一个后台线程，定期对compactionQueue中的时序数据进行压缩，压缩的操作为将compactionQueue中同一行中不同列的数据点汇总起来，写入一个列中。具体如：</p>
<p>假设原数据为 {row1,t:05A,v1}, {row1,t:05B,v2}, {row1,t:05C,v3}，则压缩后的数据为{row1,t:05A05B05C,v1v2v3}</p>
<h4 id="追加模式"><a href="#追加模式" class="headerlink" title="追加模式"></a>追加模式</h4><p> 除了压缩优化方式外，OpenTSDB还提供了一种直接追加写入点的方式，即在写入时将同一个rowkey的数据写入一个共同的qualifier中，这样可以即可以达到压缩存储的效果，也能省去开启单独压缩线程的资源消耗。具体存储方式为{row1,t:05,Av1Bv2Cv3}，即qualifier固定，值为&lt;offset1&gt;&lt;v1&gt;&lt;offset2&gt;&lt;v2&gt;……&lt;offsetN&gt;&lt;vN&gt;。</p>
<p>但追加模式也有它的缺点，数据值保存的顺序是按写入的顺序保存的，并不能保证是按offset值排序的。</p>
<h4 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h4><p>[1] OpenTSDB技术内幕</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/28/OpenTSDB%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E8%A7%84%E5%88%99/" data-id="ckdnxw3y3001rt4p526bvg8u2" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenTSDB/" rel="tag">OpenTSDB</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-OpenTSDB启动过程解析" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/19/OpenTSDB%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B%E8%A7%A3%E6%9E%90/" class="article-date">
  <time datetime="2020-05-19T08:11:31.936Z" itemprop="datePublished">2020-05-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Develop/">Develop</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/19/OpenTSDB%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B%E8%A7%A3%E6%9E%90/">OpenTSDB服务启动过程解析</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>服务启动类TSDMain位于net.opentsdb.tools包下，服务启动步骤为：</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/19/OpenTSDB%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B%E8%A7%A3%E6%9E%90/" data-id="ckdnxw3y1001it4p5akusc7ll" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenTSDB/" rel="tag">OpenTSDB</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-OpenTSDB安装部署" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/19/OpenTSDB%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2/" class="article-date">
  <time datetime="2020-05-19T06:05:29.838Z" itemprop="datePublished">2020-05-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Maintenance/">Maintenance</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/19/OpenTSDB%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2/">OpenTSDB安装部署</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>上一小节主要记录了<a href="https://qiguoxiaosheng.github.io/2020/04/20/OpenTSDB源码编译/" target="_blank" rel="noopener">OpenTSDB 源码编译过程</a>，此文对OpenTSDB的安装做一个简单的说明。</p>
<p>Opentsdb WebUI依赖Gnuplot，Gnuplot是一个命令行的交互式绘图工具。用户通过输入命令，可以设置或修改绘图环境，并以图形描述数据或函数做更进一步的分析。如果用户不需要通过web浏览器访问OpenTSDB，可以跳过此步骤。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install gnuplot</span><br></pre></td></tr></table></figure>

<p>将生成的安装包复制至希望运行的环境中，并解压，解压后的目录结构为</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">drwxr-xr-x. 2 root root   54 May 18 17:09 bin</span><br><span class="line">drwxr-xr-x. 2 root root   46 May 18 17:51 conf</span><br><span class="line">drwxr-xr-x. 3 root root 4096 May 18 17:02 gwt</span><br><span class="line">drwxr-xr-x. 2 root root 4096 May 18 17:02 lib</span><br></pre></td></tr></table></figure>

<p>修改配置文件conf/opentsdb.conf</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Where TSD should write it's cache files to</span></span><br><span class="line"><span class="comment"># *** REQUIRED ***</span></span><br><span class="line"><span class="meta">tsd.http.cachedir</span> =<span class="string">../cachedir</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Name of the HBase table where data points are stored, default is "tsdb"</span></span><br><span class="line"><span class="meta">tsd.storage.hbase.data_table</span> = <span class="string">tsdb</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Name of the HBase table where UID information is stored, default is "tsdb-uid"</span></span><br><span class="line"><span class="meta">tsd.storage.hbase.uid_table</span> = <span class="string">tsdb-uid</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A comma separated list of Zookeeper hosts to connect to, with or without</span></span><br><span class="line"><span class="comment"># port specifiers, default is "localhost"</span></span><br><span class="line"><span class="meta">tsd.storage.hbase.zk_quorum</span> = <span class="string">localhost:2181</span></span><br></pre></td></tr></table></figure>

<p>日志配置文件logback.xml按需修改。</p>
<p>启动服务</p>
<p>./opentsdb start</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/19/OpenTSDB%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2/" data-id="ckdnxw3y0001ht4p59pn6fmk4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenTSDB/" rel="tag">OpenTSDB</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-OpenTSDB3.0实践一" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/13/OpenTSDB3.0%E5%AE%9E%E8%B7%B5%E4%B8%80/" class="article-date">
  <time datetime="2020-05-13T07:39:21.524Z" itemprop="datePublished">2020-05-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Develop/">Develop</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/13/OpenTSDB3.0%E5%AE%9E%E8%B7%B5%E4%B8%80/">OpenTSDB 3.0实践一</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>记录OpenTSDB3.0的使用方法</p>
<p>1、创建Hbase表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="string">'open300:tsdb-uid'</span>,</span><br><span class="line">  &#123;<span class="keyword">NAME</span> =&gt; <span class="string">'id'</span>, COMPRESSION =&gt; <span class="string">'SNAPPY'</span>, BLOOMFILTER =&gt; <span class="string">'ROW'</span>&#125;,</span><br><span class="line">  &#123;<span class="keyword">NAME</span> =&gt; <span class="string">'name'</span>, COMPRESSION =&gt; <span class="string">'SNAPPY'</span>, BLOOMFILTER =&gt; <span class="string">'ROW'</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="string">'open300:tsdb'</span>,</span><br><span class="line">  &#123;<span class="keyword">NAME</span> =&gt; <span class="string">'t'</span>, <span class="keyword">VERSIONS</span> =&gt; <span class="number">1</span>, COMPRESSION =&gt; <span class="string">'SNAPPY'</span>, BLOOMFILTER =&gt; <span class="string">'ROW'</span>&#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">create</span> <span class="string">'open300:tsdb-tree'</span>,</span><br><span class="line">  &#123;<span class="keyword">NAME</span> =&gt; <span class="string">'t'</span>, <span class="keyword">VERSIONS</span> =&gt; <span class="number">1</span>, COMPRESSION =&gt; <span class="string">'SNAPPY'</span>, BLOOMFILTER =&gt; <span class="string">'ROW'</span>&#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">create</span> <span class="string">'open300:tsdb-meta'</span>,</span><br><span class="line">  &#123;<span class="keyword">NAME</span> =&gt; <span class="string">'name'</span>, COMPRESSION =&gt; <span class="string">'SNAPPY'</span>, BLOOMFILTER =&gt; <span class="string">'ROW'</span>&#125;</span><br></pre></td></tr></table></figure>

<p>2、启动服务</p>
<p>修改配置文件opentsdb.yaml</p>
<p>配置文件可以新建，也可以使用工程中自带的，此处为直接修改代码中自带的配置文件，主要修改了ZK地址、Hbase表名称。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The comma separated ZK quorum servers.</span></span><br><span class="line"><span class="attr">tsd.storage.zookeeper.quorum:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:2181</span></span><br><span class="line"><span class="comment"># The data and UID tables in HBase for TSDB data.</span></span><br><span class="line"><span class="attr">tsd.storage.data_table:</span> <span class="string">open300:tsdb</span></span><br><span class="line"><span class="attr">tsd.storage.uid_table:</span> <span class="string">open300:tsdb-uid</span></span><br></pre></td></tr></table></figure>

<p>启动类TSDMain位于server-undertow模块下，指定启动参数</p>
<p>–config.providers=file://D:\workspace\opentsdb-3.0\distribution\src\resources\opentsdb.yaml</p>
<p>其中，字符串前缀“file://”不能少。</p>
<p>服务启动后，可以通过浏览器访问<em><a href="http://localhost:4242/api/registry/plugins" target="_blank" rel="noopener">http://localhost:4242/api/registry/plugins</a></em>查看服务是否正在运行。</p>
<p>3、写入测试</p>
<p>尝试使用HTTP API写入几条数据 <a href="http://localhost:4242/api/put/" target="_blank" rel="noopener">http://localhost:4242/api/put/</a></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[&#123;</span><br><span class="line">    <span class="attr">"metric"</span>: <span class="string">"my.test.metric"</span>,</span><br><span class="line">    <span class="attr">"timestamp"</span>: <span class="number">1546300800</span>,</span><br><span class="line">    <span class="attr">"value"</span>: <span class="number">18</span>,</span><br><span class="line">    <span class="attr">"tags"</span>: &#123;</span><br><span class="line">       <span class="attr">"host"</span>: <span class="string">"web01"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">"metric"</span>: <span class="string">"my.test.metric"</span>,</span><br><span class="line">    <span class="attr">"timestamp"</span>: <span class="number">1546300800</span>,</span><br><span class="line">    <span class="attr">"value"</span>: <span class="number">14</span>,</span><br><span class="line">    <span class="attr">"tags"</span>: &#123;</span><br><span class="line">       <span class="attr">"host"</span>: <span class="string">"web02"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    <span class="attr">"metric"</span>: <span class="string">"my.test.metric"</span>,</span><br><span class="line">    <span class="attr">"timestamp"</span>: <span class="number">1546300860</span>,</span><br><span class="line">    <span class="attr">"value"</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="attr">"tags"</span>: &#123;</span><br><span class="line">       <span class="attr">"host"</span>: <span class="string">"web01"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">"metric"</span>: <span class="string">"my.test.metric"</span>,</span><br><span class="line">    <span class="attr">"timestamp"</span>: <span class="number">1546300860</span>,</span><br><span class="line">    <span class="attr">"value"</span>: <span class="number">32.5</span>,</span><br><span class="line">    <span class="attr">"tags"</span>: &#123;</span><br><span class="line">       <span class="attr">"host"</span>: <span class="string">"web02"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>服务抛出NPE异常</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">15</span>:<span class="number">57</span>:<span class="number">25.715</span> [XNIO-<span class="number">1</span> task-<span class="number">1</span>] ERROR net.opentsdb.servlet.exceptions.GenericExceptionMapper - Unexpected exception</span><br><span class="line">java.lang.NullPointerException: <span class="keyword">null</span></span><br><span class="line">	at net.opentsdb.servlet.resources.PutDataPointRpc.post(PutDataPointRpc.java:<span class="number">403</span>)</span><br><span class="line">	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span><br><span class="line">	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:<span class="number">62</span>)</span><br><span class="line">	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:<span class="number">43</span>)</span><br><span class="line">	at java.lang.reflect.Method.invoke(Method.java:<span class="number">498</span>)</span><br><span class="line">	at org.glassfish.jersey.server.model.internal.ResourceMethodInvocationHandlerFactory$<span class="number">1</span>.invoke(ResourceMethodInvocationHandlerFactory.java:<span class="number">81</span>)</span><br><span class="line">	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher$<span class="number">1</span>.run(AbstractJavaResourceMethodDispatcher.java:<span class="number">151</span>)</span><br><span class="line">	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.invoke(AbstractJavaResourceMethodDispatcher.java:<span class="number">171</span>)</span><br><span class="line">	at org.glassfish.jersey.server.model.internal.JavaResourceMethodDispatcherProvider$ResponseOutInvoker.doDispatch(JavaResourceMethodDispatcherProvider.java:<span class="number">152</span>)</span><br><span class="line">	at org.glassfish.jersey.server.model.internal.AbstractJavaResourceMethodDispatcher.dispatch(AbstractJavaResourceMethodDispatcher.java:<span class="number">104</span>)</span><br><span class="line">	at org.glassfish.jersey.server.model.ResourceMethodInvoker.invoke(ResourceMethodInvoker.java:<span class="number">384</span>)</span><br><span class="line">	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:<span class="number">342</span>)</span><br><span class="line">	at org.glassfish.jersey.server.model.ResourceMethodInvoker.apply(ResourceMethodInvoker.java:<span class="number">101</span>)</span><br><span class="line">	at org.glassfish.jersey.server.ServerRuntime$<span class="number">1</span>.run(ServerRuntime.java:<span class="number">271</span>)</span><br><span class="line">	at org.glassfish.jersey.internal.Errors$<span class="number">1</span>.call(Errors.java:<span class="number">271</span>)</span><br><span class="line">	at org.glassfish.jersey.internal.Errors$<span class="number">1</span>.call(Errors.java:<span class="number">267</span>)</span><br><span class="line">	at org.glassfish.jersey.internal.Errors.process(Errors.java:<span class="number">315</span>)</span><br><span class="line">	at org.glassfish.jersey.internal.Errors.process(Errors.java:<span class="number">297</span>)</span><br><span class="line">	at org.glassfish.jersey.internal.Errors.process(Errors.java:<span class="number">267</span>)</span><br><span class="line">	at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:<span class="number">297</span>)</span><br><span class="line">	at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:<span class="number">254</span>)</span><br><span class="line">	at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:<span class="number">1030</span>)</span><br><span class="line">	at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:<span class="number">373</span>)</span><br><span class="line">	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:<span class="number">381</span>)</span><br><span class="line">	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:<span class="number">344</span>)</span><br><span class="line">	at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:<span class="number">221</span>)</span><br><span class="line">	at io.undertow.servlet.handlers.ServletHandler.handleRequest(ServletHandler.java:<span class="number">74</span>)</span><br><span class="line">	at io.undertow.servlet.handlers.security.ServletSecurityRoleHandler.handleRequest(ServletSecurityRoleHandler.java:<span class="number">62</span>)</span><br><span class="line">	at io.undertow.servlet.handlers.ServletChain$<span class="number">1</span>.handleRequest(ServletChain.java:<span class="number">68</span>)</span><br><span class="line">	at io.undertow.servlet.handlers.ServletDispatchingHandler.handleRequest(ServletDispatchingHandler.java:<span class="number">36</span>)</span><br><span class="line">	at io.undertow.servlet.handlers.security.SSLInformationAssociationHandler.handleRequest(SSLInformationAssociationHandler.java:<span class="number">132</span>)</span><br><span class="line">	at io.undertow.servlet.handlers.security.ServletAuthenticationCallHandler.handleRequest(ServletAuthenticationCallHandler.java:<span class="number">57</span>)</span><br><span class="line">	at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:<span class="number">43</span>)</span><br><span class="line">	at io.undertow.security.handlers.AbstractConfidentialityHandler.handleRequest(AbstractConfidentialityHandler.java:<span class="number">46</span>)</span><br><span class="line">	at io.undertow.servlet.handlers.security.ServletConfidentialityConstraintHandler.handleRequest(ServletConfidentialityConstraintHandler.java:<span class="number">64</span>)</span><br><span class="line">	at io.undertow.security.handlers.AuthenticationMechanismsHandler.handleRequest(AuthenticationMechanismsHandler.java:<span class="number">60</span>)</span><br><span class="line">	at io.undertow.servlet.handlers.security.CachedAuthenticatedSessionHandler.handleRequest(CachedAuthenticatedSessionHandler.java:<span class="number">77</span>)</span><br><span class="line">	at io.undertow.security.handlers.AbstractSecurityContextAssociationHandler.handleRequest(AbstractSecurityContextAssociationHandler.java:<span class="number">43</span>)</span><br><span class="line">	at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:<span class="number">43</span>)</span><br><span class="line">	at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:<span class="number">43</span>)</span><br><span class="line">	at io.undertow.servlet.handlers.ServletInitialHandler.handleFirstRequest(ServletInitialHandler.java:<span class="number">292</span>)</span><br><span class="line">	at io.undertow.servlet.handlers.ServletInitialHandler.access$<span class="number">100</span>(ServletInitialHandler.java:<span class="number">81</span>)</span><br><span class="line">	at io.undertow.servlet.handlers.ServletInitialHandler$<span class="number">2</span>.call(ServletInitialHandler.java:<span class="number">138</span>)</span><br><span class="line">	at io.undertow.servlet.handlers.ServletInitialHandler$<span class="number">2</span>.call(ServletInitialHandler.java:<span class="number">135</span>)</span><br><span class="line">	at io.undertow.servlet.core.ServletRequestContextThreadSetupAction$<span class="number">1</span>.call(ServletRequestContextThreadSetupAction.java:<span class="number">48</span>)</span><br><span class="line">	at io.undertow.servlet.core.ContextClassLoaderSetupAction$<span class="number">1</span>.call(ContextClassLoaderSetupAction.java:<span class="number">43</span>)</span><br><span class="line">	at io.undertow.servlet.handlers.ServletInitialHandler.dispatchRequest(ServletInitialHandler.java:<span class="number">272</span>)</span><br><span class="line">	at io.undertow.servlet.handlers.ServletInitialHandler.access$<span class="number">000</span>(ServletInitialHandler.java:<span class="number">81</span>)</span><br><span class="line">	at io.undertow.servlet.handlers.ServletInitialHandler$<span class="number">1</span>.handleRequest(ServletInitialHandler.java:<span class="number">104</span>)</span><br><span class="line">	at io.undertow.server.Connectors.executeRootHandler(Connectors.java:<span class="number">364</span>)</span><br><span class="line">	at io.undertow.server.HttpServerExchange$<span class="number">1</span>.run(HttpServerExchange.java:<span class="number">830</span>)</span><br><span class="line">	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:<span class="number">1149</span>)</span><br><span class="line">	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:<span class="number">624</span>)</span><br><span class="line">	at java.lang.Thread.run(Thread.java:<span class="number">748</span>)</span><br></pre></td></tr></table></figure>




      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/13/OpenTSDB3.0%E5%AE%9E%E8%B7%B5%E4%B8%80/" data-id="ckdnxw3xy001dt4p5bqjkcbs8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenTSDB/" rel="tag">OpenTSDB</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-JMeter工具的使用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/05/09/JMeter%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/" class="article-date">
  <time datetime="2020-05-09T07:19:50.020Z" itemprop="datePublished">2020-05-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Test/">Test</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/05/09/JMeter%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/">JMeter工具的使用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/05/09/JMeter%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/" data-id="ckdnxw3xo000nt4p57rdnanmg" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Develop/">Develop</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Maintenance/">Maintenance</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Test/">Test</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ClickHouse/" rel="tag">ClickHouse</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DataX/" rel="tag">DataX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flink/" rel="tag">Flink</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hive/" rel="tag">Hive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Idea/" rel="tag">Idea</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kafka/" rel="tag">Kafka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenTSDB/" rel="tag">OpenTSDB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Zeppelin/" rel="tag">Zeppelin</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ClickHouse/" style="font-size: 16.67px;">ClickHouse</a> <a href="/tags/DataX/" style="font-size: 10px;">DataX</a> <a href="/tags/Flink/" style="font-size: 13.33px;">Flink</a> <a href="/tags/Hive/" style="font-size: 10px;">Hive</a> <a href="/tags/Idea/" style="font-size: 10px;">Idea</a> <a href="/tags/Kafka/" style="font-size: 10px;">Kafka</a> <a href="/tags/OpenTSDB/" style="font-size: 20px;">OpenTSDB</a> <a href="/tags/Zeppelin/" style="font-size: 10px;">Zeppelin</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">April 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/08/05/Java%E4%B8%AD%E7%9A%84Clone/">Java中的Clone</a>
          </li>
        
          <li>
            <a href="/2020/08/05/Java%E4%B8%AD%E5%BC%95%E7%94%A8%E7%9A%84%E7%B1%BB%E5%9E%8B/">Java中的引用类型</a>
          </li>
        
          <li>
            <a href="/2020/07/31/OpenTSDB%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B9%8BCompact%E6%A8%A1%E5%BC%8F/">OpenTSDB数据存储之Compact模式</a>
          </li>
        
          <li>
            <a href="/2020/07/31/OpenTSDB%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B9%8BAppend%E6%A8%A1%E5%BC%8F/">OpenTSDB数据存储之Append模式</a>
          </li>
        
          <li>
            <a href="/2020/07/30/OpenTSDB%20UID%E7%94%9F%E6%88%90%E8%A7%84%E5%88%99/">OpenTSDB UID生成规则</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 qiguoxiaosheng<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>